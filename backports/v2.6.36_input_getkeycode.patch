diff --git a/drivers/media/rc/rc-main.c b/drivers/media/rc/rc-main.c
--- a/drivers/media/rc/rc-main.c
+++ b/drivers/media/rc/rc-main.c
@@ -318,8 +318,7 @@ static unsigned int ir_establish_scancod
  * This routine is used to handle evdev EVIOCSKEY ioctl.
  */
 static int ir_setkeycode(struct input_dev *idev,
-			 const struct input_keymap_entry *ke,
-			 unsigned int *old_keycode)
+			 unsigned int scancode, unsigned int keycode)
 {
 	struct rc_dev *rdev = input_get_drvdata(idev);
 	struct ir_scancode_table *rc_tab = &rdev->rc_tab;
@@ -330,25 +329,13 @@ static int ir_setkeycode(struct input_de
 
 	spin_lock_irqsave(&rc_tab->lock, flags);
 
-	if (ke->flags & INPUT_KEYMAP_BY_INDEX) {
-		index = ke->index;
-		if (index >= rc_tab->len) {
-			retval = -EINVAL;
-			goto out;
-		}
-	} else {
-		retval = input_scancode_to_scalar(ke, &scancode);
-		if (retval)
-			goto out;
-
-		index = ir_establish_scancode(rdev, rc_tab, scancode, true);
-		if (index >= rc_tab->len) {
-			retval = -ENOMEM;
-			goto out;
-		}
+	index = ir_establish_scancode(rdev, rc_tab, scancode, true);
+	if (index >= rc_tab->len) {
+		retval = -ENOMEM;
+		goto out;
 	}
 
-	*old_keycode = ir_update_mapping(rdev, rc_tab, index, ke->keycode);
+	keycode = ir_update_mapping(rdev, rc_tab, index, keycode);
 
 out:
 	spin_unlock_irqrestore(&rc_tab->lock, flags);
@@ -436,7 +423,7 @@ static unsigned int ir_lookup_by_scancod
  * This routine is used to handle evdev EVIOCGKEY ioctl.
  */
 static int ir_getkeycode(struct input_dev *idev,
-			 struct input_keymap_entry *ke)
+			 unsigned int scancode, unsigned int *keycode)
 {
 	struct rc_dev *rdev = input_get_drvdata(idev);
 	struct ir_scancode_table *rc_tab = &rdev->rc_tab;
@@ -448,30 +435,14 @@ static int ir_getkeycode(struct input_de
 
 	spin_lock_irqsave(&rc_tab->lock, flags);
 
-	if (ke->flags & INPUT_KEYMAP_BY_INDEX) {
-		index = ke->index;
-	} else {
-		retval = input_scancode_to_scalar(ke, &scancode);
-		if (retval)
-			goto out;
-
-		index = ir_lookup_by_scancode(rc_tab, scancode);
-	}
+	index = ir_lookup_by_scancode(rc_tab, scancode);
 
 	if (index >= rc_tab->len) {
-		if (!(ke->flags & INPUT_KEYMAP_BY_INDEX))
-			IR_dprintk(1, "unknown key for scancode 0x%04x\n",
-				   scancode);
 		retval = -EINVAL;
 		goto out;
 	}
 
-	entry = &rc_tab->scan[index];
-
-	ke->index = index;
-	ke->keycode = entry->keycode;
-	ke->len = sizeof(entry->scancode);
-	memcpy(ke->scancode, &entry->scancode, sizeof(entry->scancode));
+	*keycode = &rc_tab->scan[index];
 
 	retval = 0;
 
@@ -960,8 +931,8 @@ struct rc_dev *rc_allocate_device(void)
 		return NULL;
 	}
 
-	dev->input_dev->getkeycode_new = ir_getkeycode;
-	dev->input_dev->setkeycode_new = ir_setkeycode;
+	dev->input_dev->getkeycode = ir_getkeycode;
+	dev->input_dev->setkeycode = ir_setkeycode;
 	input_set_drvdata(dev->input_dev, dev);
 
 	spin_lock_init(&dev->rc_tab.lock);
